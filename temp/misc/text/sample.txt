Background:
* configure headers = read('classpath:features/headers/feature_headers.json')
* def apiUrl = '/p13n/unified/Homepage/content'
* def body = read('classpath:features/requests/HomePage/productTileCollection.json')
* def actualResponse = read('classpath:features/response/HomePage/productTile.json')

@positive
Scenario: Get response for ProductTileModule with correct body details
    Given url baseUrl + apiUrl
    And request body
    When method POST
    * print response
    Then status 200
    And match response == actualResponse

@positive
Scenario: Check if the response follows the contract
    Given url baseUrl + apiUrl
    And request body
    And retry until response.modules != '#[0]'
    When method POST
    * print response
    Then status 200
    And match response contains { errorDetails: '#array', features: null, reqId: '#string', inflateContent: '#boolean', modules: '#array', styles: '#array' }
    And match response.modules[0] contains { zone: '#string', moduleType: '#string', moduleId: '#string', configs: '#ignore', moduleResponse: '#ignore' }
    And match response.modules[0].configs contains { items: '#array', manualShelfId: '#string', defaultStrategy: null, expandedOnPageLoad: '#string' }
    And match response.modules[0].configs.viewAllLink contains { title: '#string', linkText: '#string', clickThrough: '#ignore' }
   
